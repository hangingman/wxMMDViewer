# MMDモデル選択機能仕様

## 1. 概要

管理用ディレクトリ（`~/.wxmmd/model/`）にインポート済みのMMDモデルを一覧表示し、メニューから選択してロードする機能。
従来の不透明なドラッグ＆ドロップによる読み込みを廃止（制限）し、アプリケーションが管理するモデル資産へのアクセス性を向上させる。

## 2. モデルの認識ルール

以下の条件を満たすディレクトリをロード可能なモデルとして認識する。

* **ベースディレクトリ:** `~/.wxmmd/model/`
* **フォルダ構造:** `~/.wxmmd/model/<モデル名>/`
* **認識条件:**
    * `<モデル名>` フォルダ直下に `.pmd` 拡張子のファイルが少なくとも1つ存在すること。
    * メニューに表示される名称はフォルダ名（`<モデル名>`）とする。

## 3. 動作フロー

### 3.1 起動時のメニュー構築
1. アプリケーション起動時に `~/.wxmmd/model/` 以下をスキャン。
2. 有効なモデルフォルダを検出し、「モデルを選択」メニューに登録。
3. 内部的にメニューIDと実ファイルパスの対応マップ（`m_modelPaths`）を保持。

### 3.2 モデルの選択とロード
1. ユーザーがメニューからモデル名を選択。
2. 選択されたIDに対応する実パスを取得し、既存の `LoadModel` 処理を実行。
3. 以前に表示されていたモデルは破棄され、新しいモデルが1つだけ表示される（単一モデル表示）。

### 3.3 インポート後の動的更新
1. 「モデルをインポート...」機能により新しいモデルが追加される。
2. インポート完了時にメニュー構築処理（`PopulateModelMenu`）を再実行。
3. アプリを再起動することなく、新しく追加されたモデルがメニューに出現する。

## 4. 実装詳細

### 主要コンポーネント
- **`MMDViewer::PopulateModelMenu()`**: `wxDir` を使用してディレクトリを走査し、メニュー項目を動的に生成する。
- **`MMDViewer::OnModelSelect()`**: イベントIDからロードすべきパスを特定し、処理を委譲する。
- **イベント範囲マッピング**: `EVT_MENU_RANGE` を使用し、動的に増減するメニューIDを一括でハンドリング。

## 5. 制限事項・特記事項

- **単一表示制限**: 一度に描画できるモデルは1つのみ。
- **メニュー数制限**: 実装上の定数により、最大1000個までのモデル表示に対応。
- **DnDの廃止**: 意図しないモデルの混入を防ぐため、従来のファイルドロップによる直接読み込みは無効化されている。
